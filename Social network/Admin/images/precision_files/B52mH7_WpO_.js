if (self.CavalryLogger) { CavalryLogger.start_js(["0SnIR"]); }

__d("WebGraphQL",["ActorURI","AsyncRequest","Deferred","FBLogger","WebGraphQLConfig","XGraphQLBatchAPIController","getAsyncParams","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();var c=a.getURIBuilder().getURI(),d={exec:function(a,b){return d.execAll([a],b)[0]},execAll:function(a,d){__p&&__p();var e={},f={};a=a.map(function(a,c){c="o"+c;e[c]={doc_id:a.__getDocID(),query_params:a.__getVariables()};a=new(b("Deferred"))();f[c]=a;return a.getPromise()});var g=babelHelpers["extends"]({},b("getAsyncParams")("POST"));d&&d.actorID!=null&&(g[b("ActorURI").PARAMETER_ACTOR]=d.actorID);var h=d&&d.batchName?{batch_name:d.batchName}:{};h=new(b("AsyncRequest"))().setURI(c).setOption("suppressEvaluation",!0).setMethod("POST").setRequestHeader("Content-Type","application/x-www-form-urlencoded").setData(babelHelpers["extends"]({},h,g,{queries:JSON.stringify(e)})).setHandler(function(a){__p&&__p();a=a.getPayload();try{var c=a.response.split("\r\n");c.pop();c=c.map(function(a){return JSON.parse(a)});c.forEach(function(a){return Object.keys(a).forEach(function(b){var c=f[b];if(c){b=a[b];b.errors?c.reject(b):b.data?c.resolve(b.data):c.reject({data:{},errors:[{message:"Unexpected response received from server.",severity:"CRITICAL",response:b}]})}})})}catch(d){c=a.response;b("FBLogger")("webgraphql").catching(d).mustfix("Bad response: ","%s%s",c.substr(0,250),c.length>250?"[truncated]":"")}Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"No response received from server.",severity:"CRITICAL"}]})})}).setTimeoutHandler(b("WebGraphQLConfig").timeout,function(){Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"Request timed out.",severity:"CRITICAL"}]})})}).setErrorHandler(function(a){var b=a.getErrorDescription();Object.keys(f).forEach(function(c){f[c].isSettled()||f[c].reject({data:{},errors:[{message:b,severity:"CRITICAL",error:a.getError()}]})})});d&&d.msgrRegion&&h.setRequestHeader("X-MSGR-Region",d.msgrRegion);b("gkx")("801901")?h.setAllowCrossPageTransition(!0):d&&d.allowCrossPageTransition!=null&&h.setAllowCrossPageTransition(d.allowCrossPageTransition);h.send();return a},__forController:g};return d}e.exports=g(b("XGraphQLBatchAPIController"))}),null);
__d("BaseGraphQLSubscription",["regeneratorRuntime","Banzai","BanzaiLogger","ChannelClientID","CurrentLocale","CurrentUser","GQLSHeartbeatConfig","GraphQLSubscriptionsConfig","Random","SkywalkerManager","URI","gkx"],(function(a,b,c,d,e,f){__p&&__p();var g=b("GQLSHeartbeatConfig").heartbeat_interval,h=1e4,i=1,j=100,k="gqls_default_logging";a.prototype.getTopic=function(a){"use strict";throw new Error("getTopic() unimplemented by subclass of BaseGraphQLSubscription")};a.prototype.getQueryID=function(){"use strict";throw new Error("getQueryID() unimplemented by subclass of BaseGraphQLSubscription")};a.prototype.getQueryParameters=function(a){"use strict";throw new Error("getQueryParameters() unimplemented by subclass of BaseGraphQLSubscription")};a.prototype.getSubscriptionCallName=function(){"use strict";throw new Error("getSubscriptionCallName() unimplemented by subclass of BaseGraphQLSubscription")};a.subscribe=function(a,b,c){c===void 0&&(c={});return new this().subscribe(a,b,c)};a.prototype.subscribe=function(a,c,d){__p&&__p();d===void 0&&(d={});d.forceLogContext==null&&b("gkx")("676906")&&b("Random").coinflip(j)&&(d.forceLogContext=k);var e=this.getQueryParameters(a);d.forceLogContext!=null&&(e["%options"]={client_logged_context:d.forceLogContext});d.receiveLifecycleEvents&&(e["%options"]=babelHelpers["extends"]({},e["%options"],{heartbeat:{interval:g}}));var f={};f.transformContext=JSON.stringify(this.getTransformContext(a,e));d.policy!=null&&(f.policy=d.policy);d.customOptions!=null&&(f.customOptions=JSON.stringify(d.customOptions));a=this.getTopic(a);var h=b("SkywalkerManager").getSubscriptionType(a);this.$1("client_subscribe",e,d,h);var i=b("SkywalkerManager").subscribe(a,function(a){this.$1("receivepayload",e,d,h),c(babelHelpers["extends"]({__type:"data"},JSON.parse(a.payload)))}.bind(this),{context:f,onUnsubscribeEager:function(){this.$1("client_unsubscribe",e,d,h)}.bind(this),gqlsLifecycleHandler:function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:c({__type:"lifecycle_event",state:a});case 1:case"end":return b.stop()}},null,this)}});return{getContext:function(){return i.getContext()},unsubscribe:function(){i.unsubscribe()}}};a.subscribeWithIcebreaker_EXPERIMENTAL=function(a,b,c){"use strict";return new this().subscribeWithIcebreaker_EXPERIMENTAL(a,b,c)};a.prototype.subscribeWithIcebreaker_EXPERIMENTAL=function(a,c,d){"use strict";__p&&__p();var e=new(b("URI"))("https://streaming-graph.facebook.com/gqls_bore");e.setQueryData({access_token:d});d=this.getTopic(a);var f={topic:d,locale:b("CurrentLocale").get(),queryID:this.getQueryID(),serializedQueryParameters:JSON.stringify(this.getQueryParameters(a))};e.addQueryData(f);var g=new EventSource(e.toString(),{withCredentials:!0});g.addEventListener("message",function(a){c(JSON.parse(JSON.parse(a.data).payload))},!1);return{getContext:function(){return f},unsubscribe:function(){g.close()}}};a.prototype.getTransformContext=function(a,c){"use strict";var d=0;return{viewerID:this.getViewerID(a),appID:d,locale:b("CurrentLocale").get(),queryID:this.getQueryID(),serializedQueryParameters:JSON.stringify(c)}};a.prototype.getViewerID=function(a){"use strict";return b("CurrentUser").getID()};a.prototype.$1=function(a,c,d,e){"use strict";if(b("Banzai").isEnabled("gqls_web_logging")){var f=b("GraphQLSubscriptionsConfig").shouldAlwaysLog||d.forceLogContext?i:h;b("Random").coinflip(f)&&b("BanzaiLogger").log("GraphQLSubscriptionsLoggerConfig",{clienttime:Date.now()/1e3,client_sample_weight:f,event:a,force_log_context:d.forceLogContext,handle_type:e,mechanism:"skywalker",query_id:parseInt(this.getQueryID(),10),query_params:c,session_id:b("ChannelClientID").getID(),subscription_call:this.getSubscriptionCallName()})}};function a(){"use strict"}e.exports=a}),null);
__d("StoryArchiveAutoSavingMode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ENABLED:"ENABLED",DISABLED:"DISABLED"})}),null);